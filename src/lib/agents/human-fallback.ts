import type { ConversationState } from "./conversation-state";

/**
 * Human Fallback Reply
 * 
 * ЁЯФС р╕лр╕▒р╕зр╣Гр╕Ир╕Чр╕╡р╣Ир╕Чр╕│р╣Гр╕лр╣Й "р╣Др╕бр╣Ир╕Фр╕╣р╣Ар╕Ыр╣Зр╕Щ AI"
 * 
 * р╕лр╕ер╕▒р╕Бр╕Др╕┤р╕Фр╣Вр╕Др╕Хр╕гр╕кр╕│р╕Др╕▒р╕Н:
 * р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕бр╕╡р╕Др╕│р╕Цр╕▓р╕бр╣Гр╕лр╕бр╣И
 * р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╣Др╕Фр╣Йр╕Вр╕нр╕Вр╣Йр╕нр╕бр╕╣р╕е
 * р╕Цр╣Йр╕▓р╣Бр╕Др╣Ир╕Хр╕нр╕Ър╕гр╕▒р╕Ъ / р╕вр╕╖р╕Щр╕вр╕▒р╕Щ
 * ЁЯСЙ р╕Хр╣Йр╕нр╕Зр╕Хр╕нр╕Ър╕кр╕▒р╣Йр╕Щр╕бр╕▓р╕Б
 * 
 * тЭМ р╣Др╕бр╣Ир╕Юр╕╣р╕Фр╕вр╕▓р╕зр╣Ар╕Бр╕┤р╕Щ
 * тЭМ р╣Др╕бр╣Ир╕нр╕Шр╕┤р╕Ър╕▓р╕вр╣Ар╕Бр╕┤р╕Щ
 * тЭМ р╣Др╕бр╣Ир╣Ар╕лр╕бр╕╖р╕нр╕Щр╕нр╣Ир╕▓р╕Щ brochure
 * тЬЕ р╣Ар╕лр╕бр╕╖р╕нр╕Щр╣Бр╕нр╕Фр╕бр╕┤р╕Щр╕Юр╕┤р╕бр╕Юр╣Мр╣Ар╕нр╕З
 * 
 * тЬЕ р╕гр╕нр╕Зр╕гр╕▒р╕Ъ Tone Controller:
 * - short: р╕Хр╕нр╕Ър╕кр╕▒р╣Йр╕Щр╕бр╕▓р╕Б
 * - medium: р╕нр╕Шр╕┤р╕Ър╕▓р╕вр╣Др╕Фр╣Й 1 р╕Ыр╕гр╕░р╣Вр╕вр╕Д
 * - explain: р╕нр╕Шр╕┤р╕Ър╕▓р╕вр╣Др╕Фр╣Й р╣Бр╕Хр╣Ир╕вр╕▒р╕Зр╕лр╣Йр╕▓р╕бр╕зр╕┤р╕Кр╕▓р╕Бр╕▓р╕г
 */
export function humanFallbackReply(
  state: ConversationState
): string {
  const tone = state.tone || "short"; // default = short

  // р╕ир╕▒р╕ер╕вр╕Бр╕гр╕гр╕бр╕Ир╕бр╕╣р╕Б + р╕бр╕╡ preference р╣Бр╕ер╣Йр╕з
  if (
    state.service === "surgery" &&
    state.area === "nose" &&
    state.preference?.style
  ) {
    const style = state.preference.style;
    
    // р╣Бр╕вр╕Бр╕Хр╕▓р╕б tone
    switch (tone) {
      case "short":
        // р╕Хр╕нр╕Ър╕кр╕▒р╣Йр╕Щр╕бр╕▓р╕Б
        return `р╣Др╕Фр╣Йр╣Ар╕ер╕вр╕Др╣Ир╕░ ЁЯШК`;
        
      case "medium":
        // р╕нр╕Шр╕┤р╕Ър╕▓р╕вр╣Др╕Фр╣Й 1 р╕Ыр╕гр╕░р╣Вр╕вр╕Д
        if (style === "р╕Шр╕гр╕гр╕бр╕Кр╕▓р╕Хр╕┤") {
          return `р╣Др╕Фр╣Йр╣Ар╕ер╕вр╕Др╣Ир╕░ ЁЯШК р╕Чр╕гр╕Зр╕Шр╕гр╕гр╕бр╕Кр╕▓р╕Хр╕┤р╕Ир╕░р╣Ар╕Щр╣Йр╕Щр╣Гр╕лр╣Йр╣Ар╕Вр╣Йр╕▓р╕Бр╕▒р╕Ър╕лр╕Щр╣Йр╕▓ р╕Фр╕╣р╣Др╕бр╣Ир╕лр╕ер╕нр╕Бр╕Др╣Ир╕░ р╣Ар╕Фр╕╡р╣Лр╕вр╕зр╣Бр╕нр╕Фр╕бр╕┤р╕Щр╣Бр╕Щр╕░р╕Щр╕│р╣Бр╕Щр╕зр╣Гр╕лр╣Йр╣Ар╕лр╕бр╕▓р╕░р╕Бр╕▒р╕Ър╣Ар╕Др╕кр╕Щр╕░р╕Др╕░`;
        } else if (style === "р╣Вр╕Фр╣Ир╕З" || style === "р╕Ыр╕ер╕▓р╕вр╕Юр╕╕р╣Ир╕З") {
          return `р╣Др╕Фр╣Йр╣Ар╕ер╕вр╕Др╣Ир╕░ ЁЯШК р╕Чр╕гр╕Зр╣Вр╕Фр╣Ир╕Зр╕Ир╕░р╣Ар╕Щр╣Йр╕Щр╕Др╕зр╕▓р╕бр╕Др╕бр╕Кр╕▒р╕Фр╕Др╣Ир╕░ р╣Ар╕Фр╕╡р╣Лр╕вр╕зр╣Бр╕нр╕Фр╕бр╕┤р╕Щр╣Бр╕Щр╕░р╕Щр╕│р╣Бр╕Щр╕зр╣Гр╕лр╣Йр╣Ар╕лр╕бр╕▓р╕░р╕Бр╕▒р╕Ър╣Ар╕Др╕кр╕Щр╕░р╕Др╕░`;
        } else if (style === "р╕кр╕▓р╕вр╣Ар╕Бр╕▓р╕лр╕ер╕╡") {
          return `р╣Др╕Фр╣Йр╣Ар╕ер╕вр╕Др╣Ир╕░ ЁЯШК р╕кр╣Др╕Хр╕ер╣Мр╣Ар╕Бр╕▓р╕лр╕ер╕╡р╕Ир╕░р╣Ар╕Щр╣Йр╕Щр╕Др╕зр╕▓р╕бр╕Щр╣Ир╕▓р╕гр╕▒р╕Бр╕Др╣Ир╕░ р╣Ар╕Фр╕╡р╣Лр╕вр╕зр╣Бр╕нр╕Фр╕бр╕┤р╕Щр╣Бр╕Щр╕░р╕Щр╕│р╣Бр╕Щр╕зр╣Гр╕лр╣Йр╣Ар╕лр╕бр╕▓р╕░р╕Бр╕▒р╕Ър╣Ар╕Др╕кр╕Щр╕░р╕Др╕░`;
        }
        return `р╣Др╕Фр╣Йр╣Ар╕ер╕вр╕Др╣Ир╕░ ЁЯШК р╣Ар╕Фр╕╡р╣Лр╕вр╕зр╣Бр╕нр╕Фр╕бр╕┤р╕Щр╣Бр╕Щр╕░р╕Щр╕│р╣Бр╕Щр╕зр╣Гр╕лр╣Йр╣Ар╕лр╕бр╕▓р╕░р╕Бр╕▒р╕Ър╣Ар╕Др╕кр╕Щр╕░р╕Др╕░`;
        
      case "explain":
        // р╕нр╕Шр╕┤р╕Ър╕▓р╕вр╣Др╕Фр╣Й р╣Бр╕Хр╣Ир╕вр╕▒р╕Зр╕лр╣Йр╕▓р╕бр╕зр╕┤р╕Кр╕▓р╕Бр╕▓р╕г
        if (style === "р╕Шр╕гр╕гр╕бр╕Кр╕▓р╕Хр╕┤") {
          return `р╣Др╕Фр╣Йр╣Ар╕ер╕вр╕Др╣Ир╕░ ЁЯШК р╕Чр╕гр╕Зр╕Шр╕гр╕гр╕бр╕Кр╕▓р╕Хр╕┤р╕Ир╕░р╣Ар╕Щр╣Йр╕Щр╕Др╕зр╕▓р╕бр╕кр╕бр╕Фр╕╕р╕ер╕Бр╕▒р╕Ър╣Гр╕Ър╕лр╕Щр╣Йр╕▓ р╣Др╕бр╣Ир╣Вр╕Фр╣Ир╕Зр╣Ар╕Бр╕┤р╕Щр╣Др╕Ыр╕Др╣Ир╕░ р╕Лр╕╢р╣Ир╕Зр╕Хр╣Йр╕нр╕Зр╣Гр╕лр╣Йр╕Др╕╕р╕Ур╕лр╕бр╕нр╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Ир╕гр╕┤р╕Зр╕Бр╣Ир╕нр╕Щр╕Щр╕░р╕Др╕░ р╕Цр╕╢р╕Зр╕Ир╕░р╣Бр╕Щр╕░р╕Щр╕│р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕бр╣Др╕Фр╣Йр╕Др╣Ир╕░`;
        } else if (style === "р╣Вр╕Фр╣Ир╕З" || style === "р╕Ыр╕ер╕▓р╕вр╕Юр╕╕р╣Ир╕З") {
          return `р╣Др╕Фр╣Йр╣Ар╕ер╕вр╕Др╣Ир╕░ ЁЯШК р╕Чр╕гр╕Зр╣Вр╕Фр╣Ир╕Зр╕Ир╕░р╣Ар╕Щр╣Йр╕Щр╕Др╕зр╕▓р╕бр╕Др╕бр╕Кр╕▒р╕Фр╣Бр╕ер╕░р╕кр╕▒р╕Щр╕Чр╕╡р╣Ир╣Ар╕Фр╣Ир╕Щр╕Кр╕▒р╕Фр╕Др╣Ир╕░ р╕Лр╕╢р╣Ир╕Зр╕Хр╣Йр╕нр╕Зр╣Гр╕лр╣Йр╕Др╕╕р╕Ур╕лр╕бр╕нр╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Ир╕гр╕┤р╕Зр╕Бр╣Ир╕нр╕Щр╕Щр╕░р╕Др╕░ р╕Цр╕╢р╕Зр╕Ир╕░р╣Бр╕Щр╕░р╕Щр╕│р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕бр╣Др╕Фр╣Йр╕Др╣Ир╕░`;
        } else if (style === "р╕кр╕▓р╕вр╣Ар╕Бр╕▓р╕лр╕ер╕╡") {
          return `р╣Др╕Фр╣Йр╣Ар╕ер╕вр╕Др╣Ир╕░ ЁЯШК р╕кр╣Др╕Хр╕ер╣Мр╣Ар╕Бр╕▓р╕лр╕ер╕╡р╕Ир╕░р╣Ар╕Щр╣Йр╕Щр╕Др╕зр╕▓р╕бр╕Щр╣Ир╕▓р╕гр╕▒р╕Бр╣Бр╕ер╕░р╣Вр╕Фр╣Ир╕Зр╣Ар╕ер╣Зр╕Бр╕Щр╣Йр╕нр╕вр╕Др╣Ир╕░ р╕Лр╕╢р╣Ир╕Зр╕Хр╣Йр╕нр╕Зр╣Гр╕лр╣Йр╕Др╕╕р╕Ур╕лр╕бр╕нр╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Ир╕гр╕┤р╕Зр╕Бр╣Ир╕нр╕Щр╕Щр╕░р╕Др╕░ р╕Цр╕╢р╕Зр╕Ир╕░р╣Бр╕Щр╕░р╕Щр╕│р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕бр╣Др╕Фр╣Йр╕Др╣Ир╕░`;
        }
        return `р╣Др╕Фр╣Йр╣Ар╕ер╕вр╕Др╣Ир╕░ ЁЯШК р╕Лр╕╢р╣Ир╕Зр╕Хр╣Йр╕нр╕Зр╣Гр╕лр╣Йр╕Др╕╕р╕Ур╕лр╕бр╕нр╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Ир╕гр╕┤р╕Зр╕Бр╣Ир╕нр╕Щр╕Щр╕░р╕Др╕░ р╕Цр╕╢р╕Зр╕Ир╕░р╣Бр╕Щр╕░р╕Щр╕│р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕бр╣Др╕Фр╣Йр╕Др╣Ир╕░`;
    }
  }

  // р╕ир╕▒р╕ер╕вр╕Бр╕гр╕гр╕бр╕Ир╕бр╕╣р╕Б р╣Бр╕Хр╣Ир╕вр╕▒р╕Зр╣Др╕бр╣Ир╕бр╕╡ preference
  if (state.service === "surgery" && state.area === "nose") {
    return tone === "short" ? `р╣Др╕Фр╣Йр╣Ар╕ер╕вр╕Др╣Ир╕░ ЁЯШК` : `р╣Др╕Фр╣Йр╣Ар╕ер╕вр╕Др╣Ир╕░ ЁЯШК р╣Ар╕Фр╕╡р╣Лр╕вр╕зр╣Бр╕нр╕Фр╕бр╕┤р╕Щр╣Бр╕Щр╕░р╕Щр╕│р╣Бр╕Щр╕зр╣Гр╕лр╣Йр╣Ар╕лр╕бр╕▓р╕░р╕Бр╕▒р╕Ър╣Ар╕Др╕кр╕Щр╕░р╕Др╕░`;
  }

  // р╕бр╕╡ service + area р╣Бр╕ер╣Йр╕з р╣Бр╕Хр╣Ир╕вр╕▒р╕Зр╣Др╕бр╣Ир╕бр╕╡ preference
  if (state.service && state.area) {
    return `р╣Др╕Фр╣Йр╣Ар╕ер╕вр╕Др╣Ир╕░ ЁЯШК`;
  }

  // Default: р╕Хр╕нр╕Ър╕гр╕▒р╕Ър╕кр╕▒р╣Йр╕Щр╕бр╕▓р╕Б
  return `р╣Др╕Фр╣Йр╣Ар╕ер╕вр╕Др╣Ир╕░ ЁЯШК`;
}

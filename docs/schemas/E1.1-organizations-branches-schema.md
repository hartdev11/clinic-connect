# E1.1 — Firestore Schema: organizations & branches

## Collection: organizations

| Field | Type | Required | หมายเหตุ |
|-------|------|----------|----------|
| id | string | auto | Firestore doc ID |
| name | string | ✅ | ชื่อองค์กร |
| plan | string | ✅ | starter \| professional \| multi_branch \| enterprise |
| createdAt | Timestamp | ✅ | serverTimestamp |
| updatedAt | Timestamp | ✅ | serverTimestamp |
| _legacy_clinic_id | string | ❌ | Migration rollback (จาก clinics) |
| affiliate_id | string | ❌ | Future: Affiliate (Phase 2+) |
| white_label_config | map | ❌ | Future: White Label (Phase 2+) |

## Collection: branches

| Field | Type | Required | หมายเหตุ |
|-------|------|----------|----------|
| id | string | auto | Firestore doc ID |
| org_id | string | ✅ | FK → organizations.id |
| name | string | ✅ | ชื่อสาขา |
| address | string | ❌ | ที่อยู่สาขา |
| createdAt | Timestamp | ✅ | serverTimestamp |
| updatedAt | Timestamp | ✅ | serverTimestamp |

## ตัวอย่าง Document

### organizations (org_abc123)
```json
{
  "name": "คลินิกความงาม สวยใส",
  "plan": "professional",
  "createdAt": "2025-02-10T08:00:00.000Z",
  "updatedAt": "2025-02-10T08:00:00.000Z",
  "_legacy_clinic_id": "clinic_xyz789",
  "affiliate_id": null,
  "white_label_config": null
}
```

### branches (branch_def456)
```json
{
  "org_id": "org_abc123",
  "name": "สาขาสยาม",
  "address": "123 ถ.พระราม 1 แขวงปทุมวัน เขตปทุมวัน กรุงเทพฯ",
  "createdAt": "2025-02-10T08:00:00.000Z",
  "updatedAt": "2025-02-10T08:00:00.000Z"
}
```

---

## E1.1 Definition of Done

- [ ] TypeScript types อยู่ใน `src/types/organization.ts`
- [ ] Schema doc อยู่ใน `docs/schemas/E1.1-organizations-branches-schema.md`
- [ ] ตัวอย่าง document อยู่ใน `docs/schemas/E1.1-organizations-branches-examples.json`
- [ ] Firestore มี collections `organizations` และ `branches` (สร้างได้เมื่อมี write แรก หรือเตรียม script)
- [ ] ทุก field ตาม schema ระบุ type และ required/optional ชัดเจน
- [ ] Future-proof: affiliate_id, white_label_config, _legacy_clinic_id มีใน schema
